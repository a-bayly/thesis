# Codebase for thesis (ucabbay)

We utilise a subset of the codebase for the NCP paper to implement NCP models. The repository can be found
at https://github.com/CSML-IIT-UCL/NCP (authors: Gregoire Pacreau, Giacomo Turri, Pietro Novelli). Code cloned from that 
repository is found in the `NCP` folder and our import statements are commented where we have used this directly. In places,
we have used code that modifies material from the NCP repository, we indicate where this has occurred in the comments too.

## Utilities 

We wrote a few utilities for the purpose of the thesis, they are as follows:

- `NCP_data.py` contains code for data generation in the form of abstract base classes
- `NCP_train.py` implements some utilities for training NCP models using the pytorch Lightning module
- `LightningUtils.py` contains additional utilities for implementing early stopping and other useful features 

## [Section 3.6] NCP model diagnostics

The code that generated figures 3.2-3.8 is contained in `NCP_diagnostics.py`. This code will use the model checkpoints stored in the `models` directory to generate the relevant figures. In order to
retrain models change the `_seed_` variable in the lightning training classes. 

## NCP Experiments

- **[Section 3.8.1] Polar transform with multiplicative noise**: The code that generates figures 3.9-3.12 is contained in
`Experiment01a.py` and `Experiment01b.py`.
- **[Section 3.8.2] Recovering conditional covariance**: The code that generates figures 3.13-3.16 is contained in
`Experiment02a.py` and `Experiment02b.py`.

This code will use the model checkpoints stored in the `models` directory to generate the relevant figures. In order to
retrain models change the `_seed_` variable in the lightning training classes.

## GCDS experiment

The code in `GCDS_test.py` trains a GCDS model using the chi-squared divergence and runs diagnostics tests on samples 
generated by the trained model. See Chapter 4 for further details.